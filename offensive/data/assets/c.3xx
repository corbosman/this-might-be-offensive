/*! original file: thismight.be/offensive/js/settings.js */
var template;var old_key;$(document).ready(function(){template=$("#template").val();$(".keycode").each(function(a){code=parseInt($(this).val());value=key_value(code);$(this).val(value)});assign_click_events();$("#key_add a").click(function(a){handle_row_add($(this),a);return false});$("#keynav_form").submit(function(a){handle_save($(this),a)})});function handle_row_delete(b,a){b.parent().remove();check_delete_link()}function handle_row_add(b,a){$("#keynav table").append(template);check_delete_link();assign_click_events()}function assign_click_events(){$(".key_delete").unbind();$(".key_delete").click(function(a){handle_row_delete($(this),a);return false});$(".keycode").unbind();$(".keycode").focus(function(a){record_key($(this),a)});$(".keytype").unbind();$(".keytype select").change(function(a){if($(this).val()=="default"){$(this).parent().parent().find(".keycode").val("")}})}function check_delete_link(){count_rows=$(".key_delete").length;if(count_rows==1){$(".key_delete a").css("display","none");$(".key_delete").unbind()}else{$(".key_delete a:first").css("display","block")}}function clear_recording(b,a){$(".key_notification").each(function(c){if($(this).html()=="recording"){$(this).parent().parent().find(".keycode").val(old_key);$(this).html("")}})}function record_key(b,a){clear_recording(b,a);b.parent().parent().find(".key_notification").html("recording");old_key=b.val();b.val("");b.keydown(function(e){var c=(e.which==null)?e.keyCode:e.which;var d=c;e.preventDefault();if(c==16||c==17||c==18||c==224||c==224||c==91||c==92||c==93){return}if(e.shiftKey){c|=256}if(e.altKey){c|=512}if(e.ctrlKey){c|=1024}if(e.metaKey){c|=2048}c|=4096;d=key_value(c);b.blur();b.parent().parent().find(".key_notification").html("");b.parent().parent().find(".keycode").val(d);b.parent().parent().find(".registered_key").val(c);$(".keycode").unbind("keydown")})}function key_value(a){var b="";if(a<=255){b+="(agnostic) "}else{if(a&256){b+="(shift) "}else{if(a&512){b+="(alt) "}else{if(a&1024){b+="(ctrl) "}else{if(a&2048){b+="(meta) "}}}}}a&=255;if(a>=48&&a<=57){return b+(a-48)+" (key)"}if(a>=96&&a<=105){return b+(a-96)+" (num)"}if(a>=65&&a<=90){return b+String.fromCharCode(a).toLowerCase()}switch(a){case 27:return b+"Esc";case 37:return b+"←";case 38:return b+"↑";case 39:return b+"→";case 40:return b+"↓";case 61:return b+"+";case 106:return b+"* (num)";case 107:return b+"+ (num)";case 109:return b+"- (num)";case 110:return b+". (num)";case 111:return b+"/ (num)";case 112:return b+"F1";case 113:return b+"F2";case 114:return b+"F3";case 115:return b+"F4";case 116:return b+"F5";case 117:return b+"F6";case 118:return b+"F7";case 119:return b+"F8";case 120:return b+"F9";case 121:return b+"F10";case 122:return b+"F11";case 123:return b+"F12";case 170:return b+"- (Wii)";case 174:return b+"+ (Wii)";case 175:return b+"↑ (Wii)";case 176:return b+"↓ (Wii)";case 177:return b+"→ (Wii)";case 178:return b+"← (Wii)";case 187:return b+"=";case 189:return b+"-";default:return b+a}}function handle_save(c,b){var a=0;$("#keynav form table tr").each(function(d){$(this).find("select").attr("name","key"+a);$(this).find(".keycode").attr("name","ascii"+a);$(this).find(".registered_key").attr("name","keycode"+a);a++})};